/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java-library'
    id 'maven-publish'
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2/')
        credentials {
            username project.findProperty("mavenUsername") ?: System.getenv("MAVEN_USERNAME")
            password project.findProperty("mavenPassword") ?: System.getenv("MAVEN_PASSWORD")
        }
    }

    dependencies {
        api 'com.fasterxml.jackson.core:jackson-core:2.9.10'
        api 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.9.10'
        api 'net.java.dev.jna:jna-platform:5.12.1'
    }

    group = 'bit.sdk'
    version = '1.0-SNAPSHOT'
    description = 'JavaWrapper'
    java.sourceCompatibility = JavaVersion.VERSION_1_8

    publishing {
        publications {
            maven(MavenPublication) {
                from(components.java)
            }
        }
    }

    tasks.withType(JavaCompile) {
        options.encoding = 'UTF-8'
    }

    tasks.withType(Javadoc) {
        options.encoding = 'UTF-8'
    }

//tasks.register('copyNativeLib', Copy) {
//    delete 'src/main/resources/darwin-aarch64'
//    from '../../target/debug'
//    include '*libbitwarden_c*.dylib'
//    include '*libbitwarden_c*.so'
//    include '*bitwarden_c*.dll'
//    into 'src/main/resources/darwin-aarch64'
//}

    jar {
//    dependsOn tasks.named("copyNativeLib")
        from('src/main/resources') {
            include 'darwin-aarch64/**'
            include 'darwin-x64/**'
            include 'ubuntu-x64/**'
            include 'windows-x64/**'
        }
    }
